## STORY 01 | ADSL 기술을 이용한 액세스 회선의 구조와 동작

### 1. 인터넷의 기본은 가정이나 회사의 LAN과 같다

가정이나 회사의 네트워크 규모가 커진 것이 인터넷

인터넷의 라우터에는 경로 정보가 10만 개 이상이나 등록되어 있어 그 부분을 자동화하여 관리함

### 2. 사용자와 인터넷을 연결하는 액세스 회선

인터넷 접속용 라우터는 액세스 회선의 규칙에 따라 패킷 송신 동작을 실행

→ 인터넷 접속용 라우터는 MAC 헤더, PPPoE 헤더, PPP 헤더의 세 가지를 붙이고 ADSL 모뎀에 패킷을 보냄 (PPPoE의 경우)

인터넷 접속용 라우터가 패킷을 송신하면 패킷은 ADSL 모뎀에 도착

ADSL 모뎀은 패킷을 작게 분할하여 셀에 저장

셀은 작은 디지털 덩어리로, ATM이라는 통신 기술에 사용함.

→ ADSL 모뎀은 패킷을 셀로 분할하고, 전기 신호로 바꾸어 스플리터에 송신

### 3. ADSL 모델에서 패킷을 셀로 분할한다

인터넷 접속용 라우터는 MAC 헤더, PPPoE 헤더, PPP 헤더의 세 가지를 붙이고 ADSL 모뎀에 패킷을 보냄

### 4. ADSL은 변조 방식으로 셀을 신호화한다

ADSL 모뎀은 완만한 파형을 합성한 신호에 0과 1의 비트 값을 대응시키는 **변조 기술**을 사용.

**변조기술**

- 진폭 변조: 진폭이 작은 신호는 0, 큰 신호는 1로 대응시킴
- 위상 변조: 각도에 0과 1을 대응시

ADSL은 위에 둘 변조 방식을 결합한 **직교 진폭 변조** 방식을 사용함

두 가지 방식을 결합하여 한 개의 파에 대응시키는 비트 수를 늘려 속도를 높임

### 5. ADSL은 파를 많이 사용하여 고속화를 실현한다

여러 주파수의 파를 합성한 것을 신호로 사용하는 것도 가능함
이렇게 하면 대응시키는 비트 수는 사용하는 파의 수를 곱한 것만큼 증가함

ADSL은 다수의 파에 비트값을 대응시켜 고속화를 함

각각의 파에 직교 진폭 변조에 의해 비트값을 대응시킴
잡음이 없는 주파수의 파에는 다수의 비트를 대응시키고, 잡음이 있는 주파수의 파에는 소수의 비트를 대응시킴.

대응시킨 비트 수를 합계한 값에 의해 전체의 전송 속도가 결정됨

업로드는 26개의 파를 사용, 다운로드는 95, 223개라는 파를 사용함. 둘의 속도가 다른 이유는 파의 수 차이 때문.
높은 주파수는 감쇠가 크고 잡음 영향이 큼. 때문에 적은 비트 수만 지원하거나 사용할 수 없음

### 6. 스플리터의 역할

ADSL 모뎀에서 전기 신호는 스플리터라는 장치에 들어가고, 전화의 음성 신호와 섞여서 전화 회선에 함께 흘러나감

스플리터는 전화 회선에서 흘러들어온 신호를 전화와 ADSL의 신호로 나누는 역할을 함
ADSL의 높은 주파수를 차단하여 ADSL 모뎀에 흐르게 하고, 낮은 주파수의 전화 신호만 전화기에 흐르게 함

### 7. 전화국까지의 여정

스플리터의 앞에는 전화 케이블을 꽂은 모듈형 커넥터가 있음

이곳을 통과하여 전화의 옥내 배선을 빠져나면 건물 등의 IDF나 MDF(주 배선관)가 있음

이곳에서 밖의 배선과 옥내 배선이 접속되어 있음

이것을 지나면 보안기가 있고, 과전류를 막기 위한 것

이후에는 전주의 전화 케이블로 들어가고, 전화국에 가까워지면 지하에 있는 케이블로 들어감

이것을 모아 매설하여 **동도**라고 함

이 동도를 통해 전화국에 들어간 케이블은 전화국의 MDF에 하나씩 연결됨

### 8. 잡음의 영향

ADSL의 신호는 다수의 주파수로 나뉘어져 잡음과 주파수가 겹치는 신호만 영향을 받아서 사용할 수 없게 됨

즉 사용할 수 있는 신호의 수가 감소하여 속도가 저하됨

### 9. DSLAM을 통과하여 BAS에 도달한다

신호가 배선반과 스플리터를 통과하여 DSLAM에 도착하면 전기 신호가 디지털 셀로 복원됨
전화국에는 다수의 ADSL 모뎀에 해당하는 기능을 묶어서 하나의 케이스에 넣은 DSLAM이라는 장치를 사용

DSLAM은 이더넷 대신에 ATM 인터페이스를 가진 것이 대부분이고, 패킷을 분할한 셀의 형태 그대로 후방의 라우터와 주고받음

DSLAM을 나와 BAS라는 패킷 중계 장치에 도착함
ATM 인터페이스가 있어 셀을 수신하고 원래의 패킷으로 복원
MAC, PPPoE 헤더를 버리고 PPP 헤더 이후의 부분을 추출. 그리고 터널링용 헤더를 붙여 터널링의 출구를 향해 중계.

터널링용 출구에 있는 터널링용 라우터에 도착하면 터널링용 헤더를 분리하고 IP 패킷을 추출하여 인터넷의 내부에 중계

## STORY 02 | 광섬유를 이용한 액세스 회선(FTTH)

### 1. 광섬유와 기본

FTTH는 광섬유를 사용

**광섬**

- 이중 구조의 안쪽의 코어 부분 속에 광신호를 흘려서 디지털 데이터를 전달
- 디지털 데이터를 전기 신호로 변환한 후 전기 신호를 광신호로 변환

### 2. 싱글모드와 멀티모드의 차이

코어의 직경에 따른 종류

- 싱글모드:코어의 직경을 가늘게 만든 것, 하나의 빛이 지나감
- 멀티모드:코어의 직경이 굵은 것, 여러 빛이 지나감

싱글모드는 신호의 변형이 적어 케이블 길이를 길게 할 수 있고 멀리 떨어진 건물 사이를 연결할 때 사

→ FTTH

### 3. 광섬유를 분기시켜서 비용을 절감한다

ADSL 대신 광섬유를 사용하여 인터넷 접속 라우터, BAS를 접속하는 것이 FTTH 액세스 회선

- 분기를 나누지 X: 한 개의 광섬유로 사용자와 전화국을 접속하는 유형미디어 컨버터가 이더넷의 전기 신호를 광신호로 변환함. 광섬유는 BAS 앞에 집합형의 미디어 컨버터에 연결되어 그 속을 광신호가 흘러감

파장 다중: 파장이 다른 빛은 프리즘의 원리로 분리되어, 한 개의 광섬유를 사용하여 서로 다른 복수의 광신호를 흘림

- 분기를 나눈 것: 사용자 부근에 **광스플리터**라는 분기 장치를 설치하여 복수의 사용자를 연결결. ONU장치를 설치하여 BAS 앞에 OLT로 흘러한다.OLT가 송신의 타이밍을 조정하여 ONU에 송신 지시를 내리고, 그 지시에 따라 송신 동작을 한다.하향 신호에서는 ONU를 식별하는 정보를 부가함

## STORY 03 | 액세스 회선으로 이용하는 PPP와 터널링

### 1. 본인 확인과 설정 정보를 통지한다

**PPP:** 전화 회선을 이용한 다이얼업 접속으로 이용하는 구조

- 동작: 프로바이더의 액세스 포인트에 전화를 걸고,연결 되면 사용자명과 패스워드를 입력하여 로그인 조작을 함.
- RADIUS라는 프로토콜을 사용하여 RAS에서 봉인 확인용 서버에 전송되고, 검사받음.
- 확인 후 TCP/IP 설정 정보를 통지하는 동작을 함.
- 사용자 PC는 이 정보에 따라 IP 주소 등을 설정하며, TCP/IP의 패킷을 송-수신할 준비가 됨.

인터넷에 접속할 때는 PC에 글로벌 주소를 설정해야 하는데, 다이얼 접속은 전화번호에 따라 액세스 포인트를 전환할 수 있고, 전환한 액세스 포인트에 따라 주소가 달라져 사전에 PC 주소를 고정할 수 없음

### 2. 이더넷에서 PPP 메시지를 주고받는 PPPoE

ADSL, FTTH는 사용자와 BAS를 케이블로 고정적으로 접속하여 본인인증이 필요하지 않지만, 정보 입력 동작을 남기면 사용자명에 따라 프로바이더를 전환할 수 이써 PPP 구조를 사용함

다이얼업 접속

- PPP 프로토콜을 사용해 송신할 때는 프리앰블이나 FCS 및 신호에 대한 규정을 가진 '그릇'(=HDLC)을 준비하고, 여기에 PPP 메시지를 저장함

ADSL, FTTH

- HDLC 대신 이더넷 패킷을 그릇으로 사용함
- 이더넷에서 새롭게 사양을 만들어 PPPoE를 사용함

PPPoE는 PPP 메시지를 이더넷의 패킷에 넣어 주고받음

### 3. 터널링 기능에 의해 프로바이더에 패킷을 전달한다

BAS에는 본인 확인의 창구 역할을 하는 기능과 함께 **터널링**이라는 개념을 사용하여 패킷을 운반하는 기능도 있음

터널링

- 한쪽의 터널링 출입구에서 헤더를 포함한 패킷 전체를 넣으면, 이것이 헤더를 포함하여 그대로의 모습으로 반대쪽 출입구에 도달함
- BAS와 프로바이더의 라우터 사이에 있는 ADSL/FTTH 접속 서비스 사업자의 네트워크 안에 터널을 만듦
- 여기에 사용자와 BAS을 연결하는 액세스 회선을 연결하면, 패킷이 그 길을 통해 인터넷의 내부로 들어감

액세스 회선이 프로바이더의 라우터까지 연장됨

### 4. 액세스 회선 전체의 동작

인터넷 접속용 라우터에 프로바이더가 할당한 사용자명과 패스워드를 등록하면 인터넷 접속용 라우터는 PPPoE의 Discovery 구조에 따라 BAS를 찾

사용자명과 패스워드를 암호화(CHAP),비암호화(PAP) 방식으로 BAS에 보냄

패스워드 확인 후 BAS에서 사용자에 대해 TCP/IP의 설정 정보를 통지함

- 인터넷에 접속하는 기기에 할당한 IP 주소
- DNS 서버의 IP 주소
- 기본 게이트웨이의 IP 주소

이 설정 정보를 인터넷 접속용 라우터가 받아서 라우터 자체에 설정함

인터넷 접속용 라우터의 BAS측 포트에 글로벌 주소가 할당되고, 경로표에 기본 게이트웨이도 설정됨

그리고 인터넷 접속용 라우터는 패킷을 중계할 수 있는 상태가 됨

### 5. IP 어드레스를 할당하지 않는 언넘버드

1대 1 형태로 접속된 포트에 IP 주소를 할당하지 않아도 좋다는 특례가 있는데, 이것을 '언넘버드'라고 함

### 6. 인터넷 접속용 라우터에서 프라이비트 주소를 글로벌 주소로 변환한다

인터넷 접속용 라우터를 사용하면 BAS가 통지한 설정 정보를 라우터가 받아서 글로벌 주소를 라우터에 할당됨

PC에는 프라이비트 주소를 할당하고 PC가 보낸 패킷은 인터넷 접속용 라우터에서 주소 변환한 후 인터넷에 중계됨

### 7. PPPoE 이외의 방식

- PPPoA는 MAC 헤더와 PPPoE 헤더를 붙이지 않고 패킷을 그대로 저장함
- PPP를 사용하지 않고 이더넷의 패킷을 그대로 ADSL 신호로 변환하여 DSLAM에 송신하는 DHCP 방식도 있음

## STORY 04 | 프로바이더의 내부

### 1. POP와 NOC

액세스 회선을 통과한 패킷은 프로바이더의 POP에 설치된 라우터에 도착

NOC
프로바이더의 핵심이 되는 설비로서 POP에서 들어온 패킷이 여기에 모여듦

패킷을 중계하는 기본 동작은 차이가 없기 때문에 POP의 규모가 큰 것 -> NOC

### 2. 건물 밖은 통신 회선 등으로 접속한다

광섬유를 소유하고 있는 회사는 일반적으로 그것을 대출하는 사업도 운영함

광섬유를 가지고 있는 않는 프로바이더는 이 통신 회선을 사용하여 멀리 떨어진 장소에 있는 NOC나 POP를 연결함

## STORY 05 | 프로바이더를 경유하여 흐르는 패킷

### 1. 프로바이더끼리의 접속

웹 서버, 클라이어트 같은 프로바이더에 접속

- 프로바이더의 라우터에는 라우터끼리 경로 정보를 교환하고, 이것을 경로표에 자동으로 등록

웹 서버, 클라이어트 다른 프로바이더에 접속

- 프로바이더는 다른 프로바이더와도 경로 정보를 교환하므로 라우터에는 다른 프로바이더의 경로 정보가 등록되어 있음
- 경로표에서 다음 중계 대상을 찾아 거기에 패킷 전송을 반복하면 그 중에서 웹 서버측의 POP에 도착

### 2. 프로바이더끼리 경로 정보 교환하기

이더넷의 내부에서는 BGP라는 구조를 사용하여 프로바이더 간에 경로 정보를 교환

트랜지트

- 접속 상대에게 전체 경로를 통지. 그러면 상대는 특정 프로바이더를 통해 인터넷 전체에 패킷을 송신할 수 있음

비트랜지트

- 자신에게 직접 접속되어 있는 네트워크에 대한 경로 정보만 상대에게 통지. 그러면 상대는 자신에게 직접 접속한 네트워크로 갈 패킷만 보냄

### 3. 사내 네트워크에서 자동 등록하기

프로바이더 간의 경로 정보 교환은 특정 라우터와 1 대 1로 이루어짐

경로를 판단할 때 최단 경로, 다른 판단 요소를 매개변수로 설정할 수 있음

→ 상대측 액세스 대상에 웹 서버가 없을 때

프로바이더끼리 경로 정보를 교환하여 패킷을 보낼 수 있음

### 4. IX의 필요성

중심이 되는 설비를 설치하고, 프로바이더들이 이것을 경유하여 접속함

→ 통신 회선의 수를 억제할 수 있음

### 5. IX에서 프로바이더끼리 접속하는 모습

IX 중심에는 고속 LAN의 인터페이스를 다수 장착한 **레이어 2 스위치**가 있음

레이어 2 스위치의 기본 동작은 스위칭 허브와 같으므로 고속으로 거대한 스위칭 허브가 IX의 핵심이 됨

접속 방식

- IX와 같은 건물 광섬유 케이블로 스위치에 접속
- 통신 회선, 다크 파이버로 접속
- 라우터를 IX에 가지고 들어가 스위치에 접속
- 트래픽 집중된 곳에 IX 목적지를 설치해 이곳의 스위치와 IX 본체의 스위치를 통신 회선으로 접속